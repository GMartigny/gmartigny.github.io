<style type="text/css">
    body{
        margin: 0;
    }
    #c{
        width: 100%;
        height: 100%;
        background: #EEE;
    }
</style>
<canvas id="c"></canvas>
<script>
    var can = document.getElementById("c"),
        ctx = can.getContext("2d"),
        PI = Math.PI,
        pts = [],
        tmp = 0,
        hover = 0,
        current = {},
        previous = {
            x: 0, y: 0
        },
        abs = Math.abs;

    can.width = document.body.offsetWidth;
    can.height = document.body.offsetHeight;

    can.onmousedown = function(e){
        if(hover) hover.drag = 1;
        else tmp = new Point(e.clientX, e.clientY);
    };
    can.ondblclick = function(){
        if(hover) pts.splice(pts.indexOf(hover), 1);
    }
    can.onmousemove = function(e){
        if(tmp){
            tmp.x = e.clientX;
            tmp.y = e.clientY;
        }
        else if(hover.drag){
            hover.x = e.clientX;
            hover.y = e.clientY;
        }
        else{
            for(var i = 0; i < pts.length; ++i){
                var p = pts[i];
                if(p.isIn({
                    x: e.clientX, y: e.clientY
                })){
                    hover = p;
                    document.body.style.cursor = "move";
                    break;
                }
                else{
                    hover = 0;
                    document.body.style.cursor = "";
                }
            }
            ;
        }
    };
    can.onmouseup = function(){
        if(tmp){
            pts.push(tmp);
            tmp = 0;
        }
        else hover.drag = 0;
    };

    (function draw(){
        requestAnimationFrame(draw);
        ctx.clearRect(0, 0, can.width, can.height);

        if(pts.length){
            ctx.strokeStyle = "#333";
            //ctx.beginPath();
            //ctx.moveTo(pts[0].x, pts[0].y);
            current = {
                x: pts[0].x, y: pts[0].y
            };
            for(var i = 1; i < pts.length; ++i){
                if(pts[i + 1])
                    waveTo(pts[i], pts[i + 1]);
                else if(tmp)
                    waveTo(pts[i], tmp);
                else
                    waveTo(pts[i]);
            }
            if(tmp) waveTo(tmp);
            //ctx.stroke();
            //ctx.closePath();
        }

        ctx.fillStyle = "#AAA";
        ctx.strokeStyle = "#02A5A2";
        ctx.lineWidth = 5;
        pts.forEach(function(p){
            p.render(ctx);
        });

        ctx.strokeStyle = "#EE3126";
        if(tmp) tmp.render(ctx);
    })();

    function waveTo(aim, next){
        var c = current,
            f = 50,
            dx = next ?
            f * Math.sin((c.x - next.x) / distance(c, next) * PI) :
            f * (1),
            dy = f - abs(dx) * (c.y < aim.y ? 1 : -1);

        ctx.beginPath();
        ctx.moveTo(c.x, c.y);
        ctx.bezierCurveTo(c.x + previous.x, c.y + previous.y, aim.x - dx, aim.y - dy, aim.x, aim.y);
        ctx.strokeStyle = "#333";
        ctx.stroke();
        ctx.closePath();

        ctx.beginPath();
        ctx.moveTo(c.x, c.y);
        ctx.lineTo(c.x + previous.x, c.y + previous.y);
        ctx.strokeStyle = "#800";
        ctx.stroke();
        ctx.closePath();
        ctx.beginPath();
        ctx.moveTo(aim.x, aim.y);
        ctx.lineTo(aim.x - dx, aim.y - dy);
        ctx.strokeStyle = "#008";
        ctx.stroke();
        ctx.closePath();

        previous.x = dx;
        previous.y = dy;

        current.x = aim.x;
        current.y = aim.y;
    }
    ;

    function Point(x, y){
        this.x = x;
        this.y = y;

        this.render = function(c){
            c.beginPath();
            c.arc(this.x, this.y, Point.r, 0, 2 * PI);
            c.stroke();
            c.fill();
        };

        this.isIn = function(m){
            return distance(this, m) < Point.r;
        };
    }
    Point.r = 3;

    function distance(from, to){
        return Math.sqrt(Math.pow(to.x - from.x, 2) + Math.pow(to.y - from.y, 2));
    }
</script>