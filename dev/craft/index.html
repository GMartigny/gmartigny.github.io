<title>Mycraft</title>
<div id="ground">
</div>
<!--div class="block" id="bloc">
	<div class="top"></div>
	<div class="left"></div>
	<div class="right"></div>
</div-->
<div id="blocks"></div>
<div id="menu">
	<div id="1" class="current"></div>
	<div id="2"></div>
	<div id="3"></div>
	<div id="4"></div>
	<div id="5"></div>
	<div id="6"></div>
</div>
<script type="text/javascript">
addBlock(-43, 575);

document.oncontextmenu = function(){
	return false;
};

var ground = document.getElementById("ground");
ground.onmousedown = function(ev){
	if(isright(ev)){
		var x = Math.floor(ev.clientX / 100);
		var y = Math.floor(ev.clientY / 27);
		addBlock(27 * y, 100 * x);
	}
};

var blocks = document.getElementById("blocks");

var sta = -1;
var out;
var hold = false;

function casser(blo){
	if(hold){
		sta ++;
		out = setTimeout(casser, 200, blo);
	}
	else{
		sta = -1;
		clearTimeout(out);
	}
	
	var divs = blo.getElementsByTagName("div");
	
	for(var i=0;i<divs.length;i++){
		divs[i].style.backgroundPosition = (-(divs[i].clientWidth) * sta) + "px 0px, 0 0";
	}
	
	if(sta >= 9){
		sta = -1;
		blocks.removeChild(blo);
	}
}

function addBlock(top, left){
	var blo = document.createElement("div");
	blo.className = "block";
	//blo.id = "block";
	blo.style.top = top + "px";
	blo.style.left = left + "px";
	for(var i=0;i<3;i++){
		var side = document.createElement("div");
		side.className = (i == 0) ? "top" : ((i == 1) ? "left" : "right");
		blo.appendChild(side);
	}
	
	blo.onmousedown = function(ev){
		if(isright(ev)){
		
		}
		else{
			ev.preventDefault();
			hold = true;
			out = setTimeout(casser, 200, this);
		}
	};
	blo.onmouseup = function(){
		hold = false;
	};
	blo.onmouseout = function(){
		hold = false;
	};
	blo.onmouseover = function(){
		hold = true;
	}
	
	document.getElementById("blocks").appendChild(blo);
}

function isright(ev){
	var clic;
	if (!ev) var ev = window.event;
	if (ev.which) clic = (ev.which == 3);
	else if (ev.button) clic = (ev.button == 2);
	return clic;
}
</script>

<style>
body{
	overflow : hidden;
}
#ground{
	position : absolute;
	top : 150px;
	left : 250px;
	height : 600px;
	width : 800px;
	background : url(top.png);
	background-size : 100px 55px;
	-webkit-transform : skew(-50deg, 15deg);
	cursor : crosshair;
}

.block{
	position : absolute;
	height : 100px;
	width : 100px;
	cursor : crosshair;
}
.block > .top{
	background : url(break.png) 100px 0 no-repeat, url(top.png) 0 0 no-repeat;
	background-size : 1000% 100%, 100% 100%;
	width : 100px;
	height : 55px;
	-webkit-transform : skew(-50deg, 15deg);
}
.block > .left{
	background : url(break.png) 100px 0 no-repeat,  url(left.png) no-repeat;
	background-size : 1000% 100%, 100% 100%;
	width : 100px;
	height : 100%;
	-webkit-transform : skew(0, 15deg);
	margin : 0 0 0 -33px;
}
.block > .right{
	background : url(break.png) 100px 0 no-repeat,  url(right.png) no-repeat;
	background-size : 1000% 100%, 100% 100%;
	width : 65px;
	height : 100%;
	-webkit-transform : skew(0, -40deg);
	margin : -114px 0 0 67px;
}

#menu{
	position : fixed;
	bottom : -2px;
	right : 320px;
	left : 320px;
	height : 80px;
	border : 2px outset grey;
	border-radius : 5px 5px 0 0;
	background-color : lightgrey;
	padding-right : 0px;
}
#menu > div{
	float : left;
	height : 60px;
	width : 60px;
	margin : 10px 20px;
	background-color : grey;
}
#menu > .current{
	border : 2px solid orange;
	margin : 8px 18px;
}
</style>