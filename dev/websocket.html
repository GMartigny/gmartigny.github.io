<!DOCTYPE html>
<html>
    <head>
        <title>dumb tchat</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            #output{
                height: 100px;
                width: 300px;
                background: #EEE;
            }
        </style>
    </head>
    <body>
        <div>
            <div id="output"></div>
            <form action="#" id="discuss">
                <input type="text" name="message"/>
                <input type="submit" value="send"/>
            </form>
        </div>
        <script>
            var url = "immense-dawn-3722.herokuapp.com",
                port = "1337",
                socket = new WebSocket("ws://" + url + ":" + port),
                output = document.getElementById("output");
            
            socket.onmessage = function(data){
                var infos = JSON.parse(data.utf8Data);
                output.innerHTML = infos.time + " : " + infos.message + "<br/>You said :" + infos.youSaid;
            };
            
            document.getElementById("discuss").onsubmit = function(){
                
                socket.send(JSON.stringify({
                    message: this.message,
                    time: Date.now()
                }));
                
                return false;
            };
        </script>
    </body>
</html>
