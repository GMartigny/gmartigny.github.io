
HTMLElement.prototype.contextMenu=function(a){this.contextMenu=new ContextMenu(a);this.addEventListener("contextmenu",function(b){b.preventDefault();this.contextMenu.show(b.clientX,b.clientY)})};function ContextMenu(a){this.setOptions(a)}ContextMenu.createMenu=function(b){var a=document.createElement("div"),c=document.createElement("div");a.id="_cm";c.classList.add("holder");b.forEach(function(d){c.appendChild(ContextMenu.createMenu.group(d))});a.addEventListener("contextmenu",function(d){d.preventDefault()});a.addEventListener("click",function(d){d.stopPropagation()});a.appendChild(c);return a};ContextMenu.createMenu.group=function(a){var c=document.createElement("div");c.classList.add("group");for(var b in a){if(a[b]){if(a[b].length){c.appendChild(ContextMenu.createMenu.dropdown(b,a[b]))}else{c.appendChild(ContextMenu.createMenu.option(b,a[b]))}}else{c.appendChild(ContextMenu.createMenu.noaction(b))}}return c};ContextMenu.createMenu.option=function(c,b){var a=document.createElement("button");a.innerHTML=c;a.addEventListener("click",function(){b();ContextMenu.callHide()});return a};ContextMenu.createMenu.noaction=function(b){var a=document.createElement("div");a.innerHTML=b;a.classList.add("no-action");return a};ContextMenu.createMenu.dropdown=function(d,c){var a=document.createElement("div"),b=document.createElement("div");a.innerHTML=d;a.classList.add("parent");b.classList.add("holder");c.forEach(function(e){b.appendChild(ContextMenu.createMenu.group(e))});a.appendChild(b);return a};ContextMenu.opened=false;ContextMenu.callHide=function(a){if(ContextMenu.opened){ContextMenu.opened.hide.call(ContextMenu.opened)}};ContextMenu.prototype={refreshHTML:function(){if(this.menu){this.menu.remove()}this.menu=ContextMenu.createMenu(this.options)},setOptions:function(a){this.options=a;this.refreshHTML()},show:function(a,b){this.menu.style.left=a;this.menu.style.top=b;document.body.appendChild(this.menu);if(b+this.menu.offsetHeight>document.body.offsetHeight){this.menu.style.top=b-this.menu.offsetHeight}if(a+this.menu.offsetWidth>document.body.offsetWidth){this.menu.style.left=document.body.offsetWidth-this.menu.offsetWidth}ContextMenu.opened=this;window.addEventListener("mousedown",ContextMenu.callHide);this.menu.addEventListener("mousedown",function(c){c.stopPropagation()})},hide:function(){this.menu.remove();window.removeEventListener("mousedown",ContextMenu.callHide)}};