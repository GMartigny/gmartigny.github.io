<!DOCTYPE html>
<style>
body{
	background: #666;
}
#list .line{
	position: relative;
	margin: 10px auto;
	text-align: center;
}
#list .wrap{
	position: relative;
	display: inline-block;
	text-decoration: none;
}
#list .wrap:before, #list .wrap .after{
	position: absolute;
	color: #FFF;
	text-shadow: 0 0 4px #333;
	opacity: 0;
	transition: all linear .2s;
	z-index: 1;
}
#list .wrap:before{
	content: attr(data-num) " ";
	top: 3px;
	left: 5px;
}
#list .wrap .after{
	bottom: 3px;
	right: 5px;
}
#list .wrap:hover{
	background: radial-gradient(rgba(209,84,16,.6) 0, rgba(102,102,102,0) 70%);
}
#list .wrap:hover:before, #list .wrap:hover .after{
	opacity: 1;
}
#list .wrap .after:hover{
	color: #222;
	background: #FFF;
}
#list img{
	position: relative;
	display: block;
	box-shadow: 0 0 12px #333;
}
#buttons, #source{
	text-align: center;
}
#next{
	padding: 10px 20px;
	background: linear-gradient(rgba(200,200,200,.3) 0, rgba(0,0,0,.3) 100%) #D15410;
	border: 1px outset #999;
	border-radius: 5px;
	color: #FFF;
	font-weight: bold;
	box-shadow: 1px 1px 3px #333;
}
#next:active{
	background: linear-gradient(rgba(0,0,0,.3) 0, rgba(200,200,200,.3) 100%) #D15410;
}
</style>
<div id="list"></div>
<div id="buttons">
	<button id="next">Suivant</button>
</div>
<div id="source">
	Visit <a href="http://avasdemon.com">Ava's demon</a> for more infos
</div>
<script>
var lst = document.getElementById("list"),
	nxt = document.getElementById("next"),
	img,
	cnt = localStorage.cnt || 0,
	err = 0;


function loadNext(){
	img = document.createElement("img");
	img.src = "http://www.avasdemon.com/pages/"+ pad(++cnt) +".png";

	var line = document.createElement("div");
	line.className = "line";
	var wrap = document.createElement("a");
	wrap.className = "wrap";
	wrap.dataset.num = cnt;
	wrap.href = "http://www.avasdemon.com/pages.php?page="+cnt;
	img.onload = function(){
		wrap.appendChild(this);
		var sv = document.createElement("div");
		sv.className = "after";
		sv.innerHTML = "Save";
		sv.onclick = function(e){
			e.preventDefault();
			localStorage.cnt = this.parentNode.dataset.num-1;
		};
		wrap.appendChild(sv);

		setTimeout(loadNext, 20);
	};
	img.onerror = function(){
		img.src = "http://www.avasdemon.com/"+ pad(cnt) +".gif";

		img.onerror = function(){
			err++;

			if(err < 5){
				wrap.innerHTML = "Echec de chargement";
				setTimeout(loadNext, 9);
			}
			else wrap.innerHTML = "Fin";
		}
	};
	line.appendChild(wrap);
	lst.appendChild(line);
}
loadNext();

nxt.onclick = function(){
	lst.innerHTML = "";
	loadNext();
};

function pad(s){
	var p = "0000";
	s = s.toString();
	return p.substring(0, p.length - s.length) + s;
}
</script>